import n from"jsonwebtoken";import{accessSync as e,constants as s,readFileSync as t}from"fs";import o from"os";import{resolve as r,sep as c,join as i}from"path";const u=["TELERIK_LICENSE","KENDO_UI_LICENSE"],l=["telerik-license.txt","kendo-ui-license.txt"],a="-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2mnUVMmkth2x+N/ODszG\nOFIYBL6NOO1XWRj1wkmecKuLziJDhFz0WQmyOjY34Ymg9pLuBA9QSWrrZuvPw40N\nm0X/GBmttFmPNvca3WmJ2oKM7PpLiUU9f7Ov5WeIXnx++ts/LC/OB7FtZ+LiRgJ7\n0mZnPeTogdFrASf0zSQJv4jmX840LPa6nomWeUgIVGPLLVI14Gib8Dl+nOckqCNc\nkAUUk4IBF67DufRt9zQyRxg99ysakvHX2SDbdGvIBdxWxvhhmrBoeix0uSVtG2gm\njdvSqlPJVdvMbk1Xe2+SUldJPrxH1VrTYeRUt4yqWxy16nFJUDj9exZ202X4THkU\nJQIDAQAB\n-----END PUBLIC KEY-----";function m(e,s){return new Promise((t,o)=>{n.verify(e,s,{algorithms:["RS256"]},function(n,e){n&&o(n),t(e)})})}function f(){const n=function(){const n=process.env.INIT_CWD||process.cwd();return r(n)}().split(c),e=[],s=process.env.TELERIK_LICENSE_PATH;if(s&&s.length>0)return[s];for(let s=0;s<n.length;s++){const t=n.slice(0,n.length-s).join(c);e.push(t||c)}const t=process.env.APPDATA;return"win32"===o.platform()&&t?e.push(i(t,"Telerik")):e.push(i(o.homedir(),".telerik")),e.flatMap(n=>l.map(e=>i(n,e)))}function p(){const n=function(){for(const n of f())try{return e(n,s.R_OK),n}catch(n){}return null}();if(null!==n){return{success:!0,source:n,value:t(n,{encoding:"utf-8"}).trim()}}return{success:!1,message:f().map(n=>`* ${n}`).join("\n")}}function I(){const n=function(){for(const n of u){const e=process.env[n];if(e&&e.length>0)return{success:!0,source:n,value:e.trim()}}return{success:!1,message:`* Environment Variables: ${u.join(", ")}\n`}}();if(!0===n.success)return n;const e=p();return!0===e.success?e:{success:!1,message:"No Telerik and Kendo UI License file found.\n\nThe following locations were searched:\n"+n.message+e.message+"\n\nTo download a license key file, visit https://prgress.co/3PBSVoC"}}async function g(n){return await async function(n,e){var s;const t=await m(n,e);return(null===(s=t.licenses)||void 0===s?void 0:s.length)>0&&await Promise.all(t.licenses.map(n=>m(n,e))),t}(n,a)}async function v(n){return await m(n,a)}export{v as decodeLicenseEvidence,g as decodeLicenseKey,I as loadLicense};

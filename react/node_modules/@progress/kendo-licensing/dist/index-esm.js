function e(e){return Math.floor(e.getTime()/1e3)}function t(t,n){const i=new Date(1e3*t);return i.setDate(i.getDate()+n),e(i)}function n(){return e(new Date)}function i(e){const t=function(e){if("function"==typeof atob)return atob(e);if("function"==typeof Buffer)return Buffer.from(e,"base64").toString("utf8");throw new Error("atob is undefined")}(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}function o(e){return i(e.replace(/-/g,"+").replace(/_/g,"/"))}function r(e){return new Date(1e3*e)}function s(e,t){const n=r(t);return e>new Date(n.getFullYear(),n.getMonth(),n.getDate()+1).getTime()/1e3}function c(e,i){var r,c;let a=[];return(null===(r=e.licenses)||void 0===r?void 0:r.length)>0?a=e.licenses.map(e=>function(e){const t=e.split(".")[1],n=String.fromCharCode(...o(t));return JSON.parse(n)}(e)):(null===(c=e.products)||void 0===c?void 0:c.length)>0&&(a=e.products.map(t=>({type:t.trial?"trial":"perpetual",code:t.code,expiration:t.licenseExpirationDate,licenseId:null,userId:e.userId}))),function(e,i){const o=i.filter(e=>"usage"!==e.type).filter(t=>{var n,i;return e.productCode===t.code||(null===(n=e.redistributedBy)||void 0===n?void 0:n.includes(t.code))||(null===(i=e.productCodes)||void 0===i?void 0:i.includes(t.code))}).sort((e,t)=>t.expiration-e.expiration);return o.find(e=>"subscription"===e.type&&!s(n(),e.expiration))||o.find(t=>"perpetual"===t.type&&!s(e.publishDate,t.expiration))||o.find(e=>"subscription"===e.type&&!s(t(n(),10),e.expiration))||o.find(e=>"trial"===e.type&&!s(n(),e.expiration))||o.find(e=>"subscription"===e.type)||o.find(e=>"perpetual"===e.type)||o.find(e=>"trial"===e.type)}(i,a)}class a{constructor(e,t,n){this.productName=e,this.severity="WARN",this.code="TKL201",this.message="No Telerik and Kendo UI License found.\n  To download a license key file, visit https://prgress.co/3PwQMKZ",this.notificationMessage=`License key missing for ${e} v${t}.  A license key is required for both paid and trial usage. Learn <a href="${n}">how to set up a license key</a>.`}}class u{constructor(e,t,n){this.productName=e,this.severity="WARN",this.code="TKL202",this.message=`${e} is not listed in your current license file.\n  Learn more about ${e} licensing at ${n}`,this.notificationMessage=`No license found for ${e} v${t}.  Access to the latest updates and support requires a <a href="${n}">valid license</a>.`}}class l{constructor(e,t,n){this.productName=e,this.severity="WARN",this.code="TKL203",this.message=`Your trial has expired ${n} day(s) ago.\n  Thank you for trying out ${e}, we hope you enjoyed your trial period.\n  To continue using our product, consider upgrading to a commercial license: https://prgress.co/3C9mr1M`,this.notificationMessage=`Your trial license for ${e} v${t} has expired ${n} ago. To continue using our product, consider upgrading to a commercial license. Learn more about <a href="https://prgress.co/3PwQMdX">${e} licensing</a>.`}}class p{constructor(e,t,n,i,o){this.productName=e,this.severity="WARN",this.code="TKL204";const r=n?` version ${n}`:"";this.message=`Your current license has expired on ${t.toLocaleDateString()} and is not valid for ${e}${r}. The product was published on ${i.toLocaleDateString()}.\n  Renew your license at https://prgress.co/3Px9m5F`,this.notificationMessage=`Your license is not valid for ${e} v${n}. To continue using the product, install a <a href="${o}">valid license</a>. Renew <a href="https://prgress.co/3PwQNi1">your license</a> and download a new license key.`}}class d{constructor(e,t){this.productName=e,this.severity="INFO",this.message=`Your Trial license will expire in ${-t} day(s).\n  To acquire a commercial license, visit https://prgress.co/3PyHIoH`}}async function f(e,t){if("object"!=typeof crypto||"object"!=typeof crypto.subtle||"function"!=typeof TextEncoder||"function"!=typeof TextDecoder)return;const n=crypto.subtle,[r,s,c]=e.split("."),a=o(c),u=new TextEncoder,l=new TextDecoder,p=u.encode(`${r}.${s}`),d=l.decode(o(r));if(!("Telerik License Evidence"===JSON.parse(d).typ))throw new Error("Unknown license evidence type");const f=await function(e){const t=i(e.replace("-----BEGIN PUBLIC KEY-----","").replace("-----END PUBLIC KEY-----","").replace(/\n/gm,""));return crypto.subtle.importKey("spki",t,{name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},!0,["verify"])}(t);if(!await n.verify(f.algorithm,f,a,p))throw new Error("Invalid license evidence")}const h={data:"  {\"products\":[],\"licenses\":[\"eyJhbGciOiJSUzI1NiIsInR5cCI6IlRlbGVyaWsgTGljZW5zZSBFdmlkZW5jZSJ9.eyJjb2RlIjoiS0VORE9VSVJFQUNUIiwidHlwZSI6InBlcnBldHVhbCIsImV4cGlyYXRpb24iOjE4Mjc1ODIxMDEsInVzZXJJZCI6IjRiNjgxYTczLTlmNWQtNDNkNy04NGVkLWU3NmVlMDVlNTFlMiIsImxpY2Vuc2VJZCI6ImM0YzBlMjMxLTkyMjMtNGIwMC1hNGYyLWNlMTVhOTlhZjUzNSJ9.FOSUTCWoHYh7RxsO9dyJPwa16m3rdhHsr3-vhpsLBd0bVxJUo7Od1INlWLp8pSLM1sp06UxYQsCQoFy6VQwv_LLU829HEzfdvf_AGdaHLuYLN_yan9VjZiJpppF1rmA-EbTwFJtgIjNrxxaESE99FkOLJyJpEyrLYzShtL4psruLUceWxj_dZuxHOHR0hAtlb65i8yFJZuZT0T1InUq-u5UX3xAVZY-hV4eJJ7hd3FXqEEAp7AQaI50Dy3nHBxbvnszUx2K_twUiuUO0LlyqfUW9zW57wKcVNRT8hNlxRx4HRzKMA-yv0Aq7nM3701fXSLFfJ424J6IrEQqOEkuoPQ\"],\"userId\":\"4b681a73-9f5d-43d7-84ed-e76ee05e51e2\",\"integrity\":\"gsV/rPIH+W7ANgsJ3qPsTIZ53jCtoBXzyACEytl0x7I=\",\"scriptKey\":false,\"timestamp\":1756337757}  "};const g=new Map,y=new Set;function m(e){try{const t=JSON.parse(function(e){const t=[],n=e.trim();for(let e=0;e<n.length;e+=2){const i=n.slice(e,e+2);t.push(Number.parseInt(i,21))}let i=66;return t.map(e=>{const t=e^i;return i=e,t}).map(e=>String.fromCharCode(e)).join("")}(e));Array.isArray(t[3])&&t.splice(3,0,"");const n={products:t[1].map(([e,t,n])=>({code:e,licenseExpirationDate:t,trial:Boolean(n)})),userId:t[2],integrity:t[3],licenses:t[4],scriptKey:!0};try{const e=JSON.parse(h.data);n.products=[...e.products,...n.products],n.licenses=[...e.licenses,...n.licenses]}catch(e){}h.data=JSON.stringify(n)}catch(e){}}let v=!0;function w(i){const o=JSON.parse(h.data),y=!o.scriptKey&&!o.timestamp,m=o.scriptKey&&"undefined"==typeof KendoLicensing;let w,N,x=!1;if(y||m||!(e=>{var t,n;return(null===(t=e.licenses)||void 0===t?void 0:t.length)>0&&Promise.all(null===(n=e.licenses)||void 0===n?void 0:n.map(e=>f(e,"-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2mnUVMmkth2x+N/ODszG\nOFIYBL6NOO1XWRj1wkmecKuLziJDhFz0WQmyOjY34Ymg9pLuBA9QSWrrZuvPw40N\nm0X/GBmttFmPNvca3WmJ2oKM7PpLiUU9f7Ov5WeIXnx++ts/LC/OB7FtZ+LiRgJ7\n0mZnPeTogdFrASf0zSQJv4jmX840LPa6nomWeUgIVGPLLVI14Gib8Dl+nOckqCNc\nkAUUk4IBF67DufRt9zQyRxg99ysakvHX2SDbdGvIBdxWxvhhmrBoeix0uSVtG2gm\njdvSqlPJVdvMbk1Xe2+SUldJPrxH1VrTYeRUt4yqWxy16nFJUDj9exZ202X4THkU\nJQIDAQAB\n-----END PUBLIC KEY-----"))).then(()=>{v=!0}).catch(()=>{v=!1,g.clear()}),v})(o))w=new a(i.productName,i.version,i.licensingDocsUrl);else if(N=c(o,i),N){if("trial"===N.type){const t=function(t){const i=n()-e(t);return Math.floor(i/86400)}(r(N.expiration));s(n(),N.expiration)?w=new l(i.productName,i.version,t):(w=new d(i.productName,t),x=!0)}else if("perpetual"===N.type||"subscription"===N.type){let e=N.expiration;"subscription"===N.type&&(e=t(e,10)),s(i.publishDate,e)?w=new p(i.productName,r(N.expiration),i.version,r(i.publishDate),i.licensingDocsUrl):x=!0}}else w=new u(i.productName,i.version,i.licensingDocsUrl);const L=N,$=(null==L?void 0:L.expiration)?r(L.expiration):void 0;return{isLicenseValid:x,licenseType:null==N?void 0:N.type,licenseProductCode:null==L?void 0:L.code,expiration:$,message:w}}function N(e){if(g.has(e.name))return g.get(e.name);const{isLicenseValid:t,message:n}=w(e),i=(e=>e.productCode||e.productCodes[0])(e);return n&&!y.has(i)&&(!function(e,t){if("object"==typeof console){const i=`[${e.severity}][Telerik and Kendo UI Licensing]`+(n?` ${n}:`:"")+` ${t.productName}`,o="function"==typeof console.group;o?console.group(i):console.warn(i),console.warn(e.message),o&&console.groupEnd()}var n}(n,e),y.add(i)),g.set(e.name,t),t}export{w as getLicenseStatus,m as setScriptKey,N as validatePackage};

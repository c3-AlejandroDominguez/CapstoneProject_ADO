/**
 * @license
 *-------------------------------------------------------------------------------------------
 * Copyright Â© 2025 Progress Software Corporation. All rights reserved.
 * Licensed under commercial license. See LICENSE.md in the package root for more information
 *-------------------------------------------------------------------------------------------
 */
"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const kt=require("react"),d=require("@progress/kendo-react-common"),qt=require("@progress/kendo-data-query"),b=require("@progress/kendo-react-data-tools"),xt=require("./cells/hierarchycell/GridHierarchyCell.js"),Dt=require("./cells/editcell/GridEditCell.js"),Tt=require("./header/Header.js"),Ht=require("./header/HeaderRow.js"),Pt=require("./header/FilterRow.js"),Kt=require("./header/GroupPanel.js"),At=require("./footer/Footer.js"),u=require("./utils/index.js"),Mt=require("./cells/datacell/GridCell.js"),$e=require("./cells/groupcell/GridGroupCell.js"),Ot=require("./rows/GridRow.js"),Lt=require("./header/GridHeaderSelectionCell.js"),Qe=require("./components/noRecords/GridNoRecords.js"),Ue=require("./filterCommon.js"),Bt=require("./footer/FooterRow.js"),Ft=require("./paging/GridPagerSettings.js"),ne=require("./package-metadata.js"),_t=require("./cells/detailcell/GridDetailCell.js"),zt=require("./cells/GridDetailHierarchyCell.js"),Je=require("./components/noRecords/GridNoRecordsContainer.js"),Xe=require("./GridClientWrapper.js"),Wt=require("./components/colGroup/GridColGroup.js"),Vt=require("./components/table/GridTable.js"),Ye=require("./components/GridDropClue.js"),Ze=require("./components/GridDragClue.js"),pe=require("./components/table/GridTableBody.js"),jt=require("./components/PagerContainer.js"),$t=require("./components/table/GridTableScrollable.js"),et=require("./components/GridElementContainer.js"),Qt=require("./components/GridContainerElementContainer.js"),Ut=require("./components/VirtualScrollHeightContainer.js"),ie=require("./messages/index.js"),Jt=require("./components/GridDraggableRowsContainer.js"),Xt=require("./cells/rowreordercell/GridRowReorderCell.js"),Yt=require("./header/client/GridHeaderRowReorderCell.js"),tt=require("./components/GridLoader.js"),Zt=require("./utils/premium.js"),at=require("@progress/kendo-react-intl"),pt=require("./utils/virtualColumns.js"),ea=require("./components/GridEditDialog.js"),ta=require("./cells/datacell/GridCellServer.js"),aa=require("./cells/editcell/GridEditCellServer.js"),la=require("./cells/selectioncell/GridSelectionCellServer.js"),ra=require("./cells/selectioncell/GridSelectionCell.js"),na=require("./cells/hierarchycell/GridHierarchyCellServer.js"),ia=require("./cells/rowreordercell/GridRowReorderCellServer.js"),oa=require("./cells/detailcell/GridDetailCellServer.js"),da=require("./cells/groupcell/GridGroupCellServer.js");function ca(e){const P=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const G in e)if(G!=="default"){const S=Object.getOwnPropertyDescriptor(e,G);Object.defineProperty(P,G,S.get?S:{enumerable:!0,get:()=>e[G]})}}return P.default=e,Object.freeze(P)}const l=ca(kt),lt=l.forwardRef((e,P)=>{var Te,He,Pe,Ke,Ae,Me,Oe,Le,Be,Fe,_e,ze;const G=e.id+"-role-element-id",S=e.navigatable?G:"";let k=e.columnsState||[];const rt=(t,n,i,c,o,a,s)=>{const m=[],y=u.flatData(m,t,n,{index:i},c!==void 0,o,a,yt.defaultExpand,s);return{flattedData:m,resolvedGroupsCount:y}},nt=t=>{const n=t.filter(i=>i&&i.type&&i.type.displayName==="KendoReactGridColumn");return u.readColumns(n,k,{prevId:0,idPrefix:S})},it=()=>{const t=[],n=(i,c)=>i==null?void 0:i.forEach(o=>{const a=o.hidden||c;t.push({...o,hidden:a}),n(o.children,a)});return n(k,!1),t},ot=t=>{const n=it();return t.filter(i=>{var c;return!i.hidden&&!((c=n.find(o=>o.id===i.id))!=null&&c.hidden)})},dt=(t,n)=>{g=nt(t),g.filter(i=>!i.hidden).length===0&&(g=u.autoGenerateColumns(E,e.group,{column:A.column},{prevId:0,idPrefix:S})),st(g,n),g=ot(g),K=u.mapColumns(g,!0),ce=g.map(u.clientColumn)},ct=(t,n)=>{const i=c=>{var a;const o=n.find(s=>s.id===c.id);return o?(o.children=(a=c.children)==null?void 0:a.map(i),o):u.getColumnState(c)};k=t.filter(c=>c.parentIndex===-1).map(i)},st=(t,n)=>{t.filter(a=>a.columnType==="checkbox").forEach(a=>{a.width=a.width||"50px",a.defaultCell=e.isClient?ra.GridSelectionCell:la.GridSelectionCellServer,a.defaultHeaderCell=Lt.GridHeaderSelectionCell,a._type="edit"}),D!==void 0&&t.filter(a=>a.columnType==="reorder").forEach(a=>{a.width=a.width||"50px",a.defaultCell=e.isClient?Xt.GridRowReorderCell:ia.GridRowReorderCellServer,a.defaultHeaderCell=Yt.GridHeaderRowReorderCell,a.sortable=!1,a.filterable=!1,a.editable=!1});const i=u.getFlatColumnsState(k);ct(t,i);const c={id:"",resizable:!0,width:"32px",title:" ",declarationIndex:-1,orderIndex:-1,children:[],parentIndex:-1,depth:0,colSpan:0,headerColSpan:0,rowSpan:0,left:0,right:0,index:0,rightBorder:!1,ariaColumnIndex:0,isAccessible:!0};let o=0;if(A.enabled&&e.detail){const a={...c,_type:"expand",id:b.tableKeyboardNavigationTools.generateNavigatableId(`${o++}`,"expand","column"),defaultCell:e.isClient?xt.GridHierarchyCell:na.GridHierarchyCellServer,field:A.column,headerClassName:d.classNames(f.hierarchyCell({}))};t.unshift(a),k.unshift(i.find(s=>s.id===a.id)||u.getColumnState(a))}for(let a=0;a<n;a++){const s={...c,isAccessible:!1,defaultCell:e.isClient?$e.GridGroupCell:da.GridGroupCellServer,id:b.tableKeyboardNavigationTools.generateNavigatableId(`${o++}`,"group","column"),field:"value",locked:e.lockGroups};t.unshift(s),k.unshift(i.find(m=>m.id===s.id)||u.getColumnState(s))}t.slice(o).forEach(a=>{a.parentIndex>=0&&(a.parentIndex+=o),a.rowSpannable=a.rowSpannable!==void 0?u.getRowSpanOptions(a.rowSpannable):fe})},oe=()=>e.isClient?g:ce,de=t=>{const n=[];let i=null,c=0;if(h.forEach((o,a)=>{const s=parseFloat((o.width||"").toString())||10;if(c){c--,i&&(i.width+=s);return}const m=Math.min(u.getColSpan(o,t),h.length-a);c=m-1,i={width:s,colSpan:m,columnIndex:a},n.push(i)}),e.columnVirtualization){const o=gt.current||0,a=mt.current||parseFloat(((e.style||{}).width||"").toString());return pt.getVirtualCellsToRender({cellModels:n,columns:h,tableViewPortWidth:a,scrollLeft:o})}return n},ut=()=>{const{pageable:t,take:n,pageSize:i}=e;if(!R)return 0;if(!t){if(n)return n;if(i)return i}const c=e.rowHeight||bt.current,o=ft.current;return o&&c?Math.ceil(o/c*1.5):0};let C=[],$,g=[],ce=[],K=[[]];const gt=e.scrollLeftRef||{current:0},mt=e.widthRef||{current:0},ft=e.containerHeightRef||{current:0},bt=e.minRowHeightRef||{current:0},_=e.localization||new at.LocalizationService(e.language),Ct=e.intl||new at.IntlService((Te=e.locale)!=null?Te:"en"),x=e.unstyled,f=x&&x.uGrid?x.uGrid:d.uGrid,D=u.isRowReorderEnabled(e.rowReorderable),R=e.scrollable==="virtual"||e.scrollable===void 0&&e.isClient&&d.hasValidLicense(ne.packageMetadata)||!1,se=d.getLicenseMessage(ne.packageMetadata),T=e.autoProcessData===!0?{group:!0,sort:!0,filter:!0,search:!0,page:!0}:e.autoProcessData;let E,q;if(Array.isArray(e.data)?(E=e.data,q=(He=e.total)!=null?He:E.length):(E=((Pe=e.data)==null?void 0:Pe.data)||[],q=(Me=(Ae=e.total)!=null?Ae:(Ke=e.data)==null?void 0:Ke.total)!=null?Me:E.length),T){const t=T.page&&!(R&&!e.pageable),{data:n,total:i}=qt.process(E,{group:T.group?e.group:void 0,sort:T.sort?e.sort:void 0,filter:b.combineFilters(T.filter?e.filter:void 0,T.search?e.search:void 0),...t?{take:e.pageable?e.take||10:e.take,skip:e.skip||0}:{}});E=n,q=(Oe=e.total)!=null?Oe:i}const z=E.length===q,{size:I="medium"}=e,ht=typeof e.groupable=="object"&&e.groupable.footer||"none",W=e.groupable===!0||typeof e.groupable=="object"&&e.groupable.enabled!==!1,A=b.getDetailExpandableOptions(!!e.detail),yt=b.getGroupExpandableOptions(typeof e.groupable=="object"&&e.groupable.enabled!==!1?e.groupable.expandable:e.groupable),ue=!!((Le=e.group)!=null&&Le.length),{resolvedGroupsCount:Gt,flattedData:wt}=rt(E,ht,z?0:e.skip||0,e.group,e.detailExpand,e.groupExpand,e.dataItemKey);C=wt;const Q=ut(),U=((Be=e.virtualSkipRef)==null?void 0:Be.current)||0;let ge=q;if(R){let t=e.skip||0;if((ue||e.pageable)&&(t=U,ge=C.length),z||ue||e.pageable)if(Q===0){const n=Math.min(e.take||e.pageSize||20,C.length);$=C.slice(t,t+n)}else $=C.slice(t,t+Q)}const me=b.getSelectionOptions(e.selectable),fe=u.getRowSpanOptions(e.rowSpannable),St=me&&me.drag?"none":void 0,V=l.useMemo(()=>l.Children.toArray(e.children),[e.children]);dt(V,Gt);const J=l.useMemo(()=>{const t=Zt.gridPremiumFeatures(e,g);return{premium:t.length>0,features:t}},[e,g]),be=l.useMemo(()=>J.premium?!d.validatePackage(ne.packageMetadata,{component:"Grid",features:J.features}):!1,[J.premium]),Ce=V.map(t=>t&&t.type&&t.type.displayName==="KendoReactGridToolbar"?l.cloneElement(t,{...t.props,_ariaControls:G,ariaLabel:"Top toolbar"}):null),j=V.filter(t=>t&&t.type&&t.type.displayName==="KendoReactGridNoRecords"),he=V.filter(t=>t&&t.type&&t.type.displayName==="KendoReactGridStatusBar"),h=g.filter(t=>t.children.length===0),ye=W&&l.createElement(Kt.GroupPanel,{columns:oe(),group:e.group||[],ariaControls:G}),Ge=l.createElement(Tt.Header,{size:I,staticHeaders:e.scrollable!=="none",draggable:e.reorderable||W,headerRow:l.createElement(Ht.HeaderRow,{cells:e.cells,sort:e.sort,sortable:e.sortable,group:e.group||[],groupable:W,filter:e.filter,filterable:e.filterable,filterOperators:e.filterOperators||Ue.operators,columnMenu:e.columnMenu,columnMenuIcon:e.columnMenuIcon,columns:g,columnsMap:K,navigatable:!!e.navigatable,localization:_,unstyled:x,headerSelectionValue:!!(e.select&&C.filter(t=>t.rowType==="data").every(t=>e.select&&e.dataItemKey&&d.getter(e.dataItemKey)(t.dataItem)!==void 0?e.select[d.getter(e.dataItemKey)(t.dataItem)]:void 0))}),filterRow:e.filterable&&l.createElement(Pt.FilterRow,{cells:e.cells,size:I,columns:g,filter:e.filter,filterOperators:e.filterOperators||Ue.operators,sort:e.sort,navigatable:!!e.navigatable,ariaRowIndex:K.length+1,localization:_})||void 0,cols:h.map((t,n)=>l.createElement("col",{key:n.toString(),width:u.getColumnWidth(t)}))}),we=h.findIndex(t=>typeof t.colSpan=="function")>-1;let X;we||(X=de(null));const Y=((Fe=e.editable)==null?void 0:Fe.mode)==="dialog",Et=(_e=e.editable)==null?void 0:_e.enabled,vt=(t,n,i,c,o)=>{let a=!1;const s=e.select&&e.dataItemKey&&d.getter(e.dataItemKey)(t.dataItem)!==void 0?e.select[d.getter(e.dataItemKey)(t.dataItem)]:void 0,m=e.highlight&&e.dataItemKey&&d.getter(e.dataItemKey)(t.dataItem)!==void 0?e.highlight[d.getter(e.dataItemKey)(t.dataItem)]:void 0;return we&&(X=de(t.dataItem)),{row:X.map(({columnIndex:y,colSpan:H})=>{var F,We,Ve,je;const r=h[y];let v;if((F=r.rowSpannable)!=null&&F.enabled&&t.rowType==="data"&&r.field&&o){const N=r.field?(Ve=(We=r.rowSpannable).valueGetter)==null?void 0:Ve.call(We,t.dataItem,r.field):null;v={value:N,count:1},o[r.field]&&((je=o[r.field])==null?void 0:je.value)===N&&o[r.field]!==null?(o[r.field].count++,v.count=null):o[r.field]=v}const w=r.id?r.id:y,te=d.classNames(f.contentSticky({locked:r.locked}),r.className),ae=r.left!==void 0?{left:r.left,right:r.right}:{};let O=!1;if(r.editable&&e.editable){const N=e.edit&&e.dataItemKey?e.edit[d.getter(e.dataItemKey)(t.dataItem)]:void 0,re=typeof N=="boolean"?N:Array.isArray(N)?r.field&&N.indexOf(r.field)>-1:r.field!==void 0&&N===r.field;re&&r.columnType==="data"&&(re===!0||re===r.field)&&(a=!0,Y||(O=!0))}const L=r._type==="expand",B={locked:e.lockGroups,id:b.tableKeyboardNavigationTools.generateNavigatableId(`${n}-${String(y)}`,S,L||t.rowType==="groupHeader"||t.rowType==="groupFooter"||r.field==="value"?"nodata":"cell"),colSpan:H,dataItem:t.dataItem,field:r.field,editor:r.editor,format:r.format,columnType:r.columnType,rowReorderable:D,className:te,cells:u.resolveCells(e.cells,r.cells),columnIndex:y,columnsCount:h.length,rowType:t.rowType,level:t.level,expanded:t.expanded,dataIndex:t.dataIndex,rowDataIndex:i,columnPosition:ae,style:{},ariaColumnIndex:r.ariaColumnIndex,isSelected:!!((r==null?void 0:r._type)==="edit"?s:Array.isArray(s)&&s.indexOf(y)>-1),isHighlighted:!!((r==null?void 0:r._type)==="edit"?m:Array.isArray(m)&&m.indexOf(y)>-1),isSorted:!!u.isSorted(r.field,e.sort),isInEdit:O,isAlt:c,unstyled:x,group:t.group,localization:_,intl:Ct,_rowSpan:v},le=r.defaultCell||O&&(e.isClient?Dt.GridEditCell:aa.GridEditCellServer)||(e.isClient?Mt.GridCell:ta.GridCellServer);return l.createElement(le,{key:w,cellProps:B})}),isInEdit:a,isSelected:typeof s=="boolean"&&s,isHighlighted:typeof m=="boolean"&&m}};let Rt=0,Z=null;const Se=t=>t>=C.length-Rt,p=[],Ee=!C.length;let M=0;if(C.length){const t=K.length+(e.filterable?1:0)+1;let n=e.skip||0,i=-1,c=0;const o=fe.enabled?{}:void 0;if(R){if(U>0){const a=C.slice(0,U).filter(s=>s.rowType==="data").length;i+=a,n+=a}!e.pageable&&z&&(i+=e.skip||0)}($||C).forEach((a,s)=>{a.rowType==="data"&&i++;const m=a.dataIndex%2!==0,y=e.dataItemKey&&d.getter(e.dataItemKey)(a.dataItem),H=s+n,r=y||"ai"+H,v=r+"_1",w=vt(a,r,i,m,o);if(M=H+t+c,Y&&Et&&w.isInEdit&&(Z=a.dataItem),p.push(l.createElement(Ot.GridRow,{key:r,dataItem:a.dataItem,isAltRow:m,isInEdit:w.isInEdit&&!Y,rowType:a.rowType,isRowReorderable:D,isHidden:Se(s),onClick:null,onDoubleClick:null,rowHeight:e.rowHeight,ariaRowIndex:M,absoluteRowIndex:H,dataIndex:i,isSelected:w.isSelected,isHighlighted:w.isHighlighted,rows:e.rows},w.row)),e.detail&&a.rowType==="data"&&a.expanded){const te=h.length-(A.enabled?1:0)-(e.group?e.group.length:0)||1;c++,M=H+t+c;const ae=e.isClient?_t.GridDetailCell:oa.GridDetailCellServer;p.push(l.createElement("tr",{key:v,className:d.classNames(f.detailTr({isAlt:m})),style:{visibility:Se(s)?"hidden":"",height:e.detailRowHeight},role:"row","aria-rowindex":M},e.group&&e.group.map((O,L)=>{var F;const B=(F=w==null?void 0:w.row[L])==null?void 0:F.props.style,le=B?{left:B.left,right:B.right}:{};return l.createElement($e.GridGroupCell,{key:L,cellProps:{id:"",dataItem:a.dataItem,field:O.field,dataIndex:a.dataIndex,columnPosition:le,style:{},ariaColumnIndex:1+L,isSelected:!1,locked:e.lockGroups,cells:e.cells,group:a.group}})}),A.enabled&&l.createElement(zt.GridDetailHierarchyCell,{unstyled:x,id:b.tableKeyboardNavigationTools.generateNavigatableId(`${v}-dhcell`,S)}),l.createElement(ae,{dataItem:a.dataItem,dataIndex:a.dataIndex,colSpan:te,ariaColIndex:2+(e.group?e.group.length:0),detail:e.detail,id:b.tableKeyboardNavigationTools.generateNavigatableId(`${v}-dcell`,S)})))}})}const ve={size:I,total:q,skip:e.skip||0,take:(e.take!==void 0?e.take:e.pageSize)||10,...Ft.normalize(e.pageable||{})},Re=l.createElement(jt.PagerContainer,null,e.pager?l.createElement(e.pager,{...ve}):l.createElement(b.Pager,{className:d.classNames(f.pager({})),...ve})),It=(t,n)=>l.createElement("col",{key:n.toString(),width:u.getColumnWidth(t)}),Ie=(ze=e.cells)!=null&&ze.footerCell||g.some(t=>{var n;return!!((n=t.cells)!=null&&n.footerCell)})?l.createElement(At.Footer,{size:I,staticHeaders:e.scrollable!=="none",row:l.createElement(Bt.FooterRow,{cells:e.cells,idPrefix:S,columns:g,ariaRowIndex:M+1}),cols:h.map(It)}):null,Ne=l.createElement(Wt.GridColGroup,null,h.map((t,n)=>l.createElement("col",{key:n.toString(),className:u.isSorted(t.field,e.sort)?d.classNames(f.sorted({})):void 0,width:u.getColumnWidth(t)}))),ke=e.reorderable||W,{detail:sa,cells:ua,rows:ga,...Nt}=e,qe=l.createElement("tbody",{role:"rowgroup",className:d.classNames(f.tbody({})),...b.tableKeyboardNavigationBodyAttributes},p),xe=Z?l.createElement(ea.GridEditDialog,{columns:h,customEditDialog:e.editDialog,dataItem:Z}):null;let ee=qe;D&&(ee=l.createElement(Jt.GridReorderableRowsContainer,{unstyled:f,columns:g,rowReorderSettings:e.rowReorderable},qe));const De={gridRef:P,innerGrid:e.innerGrid,gridProps:Nt,columnsRef:oe(),columnsMapRef:K,columnsState:k,dataRef:C,id:G,virtualTotal:ge,isAllData:z,virtualPageSize:Q,isVirtualScroll:R,detailExpandable:!!e.detail};return e.scrollable==="none"?l.createElement(Xe.GridClientWrapper,{...De},l.createElement(et.GridElementContainer,null,l.createElement("div",{id:e.id,style:e.style,className:d.classNames(f.wrapper({size:I}),e.className),...b.tableKeyboardNavigationScopeAttributes},Ce,ye,l.createElement(Vt.GridTable,{selectable:e.selectable,className:d.classNames(f.table({size:I}))},Ne,Ge,l.createElement(pe.GridTableBody,{rowReorderable:D},ee),Ie),Ee&&l.createElement(Je.GridNoRecordsContainer,null,j.length?j:l.createElement(Qe.GridNoRecords,null)),ke&&l.createElement(l.Fragment,null,l.createElement(Ye.GridDropClue,null),l.createElement(Ze.GridDragClue,null)))),he,e.pageable&&Re,l.createElement(tt.GridLoader,{loader:e.loader,showLoader:e.showLoader}),xe,be&&l.createElement(d.WatermarkOverlay,{message:se})):l.createElement(Xe.GridClientWrapper,{...De},l.createElement(et.GridElementContainer,null,l.createElement("div",{id:e.id,style:e.style,className:d.classNames(f.wrapper({size:I,virtual:R}),e.className),...b.tableKeyboardNavigationScopeAttributes},Ce,ye,l.createElement("div",{className:d.classNames(f.ariaRoot({})),role:"grid","aria-colcount":h.length,"aria-rowcount":q,id:G,"aria-label":_.toLanguageString(ie.gridAriaLabel,ie.messages[ie.gridAriaLabel])},Ge,l.createElement("div",{className:d.classNames(f.container({})),role:"presentation"},l.createElement(Qt.GridContainerElementContainer,null,l.createElement("div",{className:d.classNames(f.content({})),role:"presentation"},l.createElement("div",{className:d.classNames(f.tableWrap({})),role:"presentation"},l.createElement($t.GridTableScrollable,{selectable:e.selectable,tableClassName:d.classNames(f.table({size:I})),tableStyle:{userSelect:St}},Ne,l.createElement(pe.GridTableBody,{rowReorderable:D},ee)),Ee&&l.createElement(Je.GridNoRecordsContainer,null,j.length?j:l.createElement(Qe.GridNoRecords,null))),R&&l.createElement("div",{className:d.classNames(f.heightContainer({})),role:"presentation"},l.createElement(Ut.VirtualScrollHeightContainer,{isVirtualScroll:R}))))),Ie,ke&&l.createElement(l.Fragment,null,l.createElement(Ye.GridDropClue,null),l.createElement(Ze.GridDragClue,null)),be&&l.createElement(d.WatermarkOverlay,{message:se})),he,e.pageable&&Re,l.createElement(tt.GridLoader,{loader:e.loader,showLoader:e.showLoader}),xe)))});lt.displayName="KendoReactGridComponent";exports.GridComponent=lt;
